# VRChatパフォーマンス最適化ガイド

!!! note "ガイド情報"
    **所要時間**: 約90分 | **難易度**: 中級者向け | **重要度**: VRChat実用の必須知識

**このページの目的**: VRChatでの快適な動作を実現するため、衣装の軽量化と品質のベストバランスを習得します。

!!! success "このガイドで実現すること"
    - ✅ VRChat Performance Rating「Good」以上の安定達成
    - ✅ 他のユーザーからも見える軽量アバターの制作
    - ✅ 品質を損なわない効率的な最適化テクニック
    - ✅ トラブル予防とパフォーマンス問題の解決能力

!!! info "事前準備"
    - [布の物理特性設定](fabric-properties.md)を理解済み
    - VRChat SDK3でのBuild & Testを体験済み
    - Unity内でのパフォーマンス確認方法を理解
    - 基本的な衣装制作を完了している

## 🎯 VRChatパフォーマンス基準の理解

### Performance Rating システム

!!! info "VRChat Performance Rating 基準"

    **PC版基準**:
    ```
    Excellent (緑): 全項目が推奨範囲内
    Good (黄緑): ほぼ推奨範囲内、一般的に問題なし
    Medium (黄): やや重い、一部ユーザーで非表示の可能性
    Poor (オレンジ): 重い、多くのユーザーで非表示
    Very Poor (赤): 非常に重い、ほとんどのユーザーで非表示
    ```

    **Quest版基準** (より厳格):
    ```
    Triangle Count: 7,500以下 (PC: 20,000以下)
    Material Slots: 1個 (PC: 8個以下)
    Texture Memory: 10MB以下 (PC: 40MB以下)
    ```

### 最適化の優先順位

!!! example "効果的な最適化の順序"

    **Phase 1: 基本構造最適化** (最も重要)
    1. ポリゴン数の削減・統合
    2. マテリアル数の最小化
    3. テクスチャサイズの最適化

    **Phase 2: Marvelous Designer最適化**
    4. Particle Distance調整
    5. Self Collision最小化
    6. Simulation Quality調整

    **Phase 3: Unity統合最適化**
    7. Mesh結合・最適化
    8. LOD設定（上級）
    9. Shader最適化

## 📐 ポリゴン最適化戦略

### Marvelous Designer段階での最適化

!!! example "MD段階でのポリゴン削減"

    **Particle Distance による制御**:
    ```
    高密度 (6-8): 20,000-40,000 triangles
    標準 (8-10): 10,000-20,000 triangles (推奨)
    低密度 (10-12): 5,000-10,000 triangles
    最軽量 (12-15): 3,000-5,000 triangles
    ```

    **効率的なParticle Distance設定**:
    1. **複雑な衣装**: 全体8、細部のみ6で部分的高密度
    2. **シンプル衣装**: 全体10で統一
    3. **背景衣装**: 12-15で極限軽量化
    4. **重要衣装**: 8を基本に、必要に応じて6

### パターン設計での最適化

!!! example "効率的なパターン設計"

    **統合可能パーツの判断**:
    ```
    統合推奨:
    - 前身頃 + 後身頃 (縫い目が少ない場合)
    - 袖 (左右同形状の場合)
    - 装飾パーツ (小さなポケット、リボンなど)

    分離維持:
    - 動きの異なる部分 (身頃 vs スカート部分)
    - 材質設定の異なる部分
    - 色・テクスチャの大きく異なる部分
    ```

    **不要詳細の除去**:
    - 極小装飾パーツ（1cm未満）
    - 見えない内部構造
    - 過度に複雑な縫製ライン
    - 機能しない装飾的縫い目

## 🎨 マテリアル・テクスチャ最適化

### マテリアル統合戦略

!!! example "効率的なマテリアル管理"

    **統合の基本方針**:
    ```
    理想的構成:
    - メイン衣装: 1-2マテリアル
    - 複雑衣装: 最大3-4マテリアル
    - 特殊衣装: やむを得ない場合のみ5+

    統合方法:
    1. 類似色のパーツを同一マテリアル
    2. UV マッピングでの色分け活用
    3. テクスチャ内での領域分割
    ```

    **Unity段階でのマテリアル統合**:
    1. **Material結合**: 同じシェーダー・設定のマテリアル統合
    2. **Texture Atlas作成**: 複数テクスチャを1枚に統合
    3. **不要Material削除**: 使用されていないマテリアル除去

### テクスチャ最適化

!!! example "テクスチャサイズ最適化"

    **推奨テクスチャサイズ**:
    ```
    メインテクスチャ: 1024x1024 (標準)
    詳細テクスチャ: 512x512
    小物・装飾: 256x256
    背景・見えにくい部分: 128x128
    ```

    **圧縮設定 (Unity)**:
    ```
    PC版: DXT1/DXT5 (高品質)
    Quest対応: ASTC 6x6 (バランス)
    軽量化重視: ASTC 8x8 (最軽量)
    ```

    **テクスチャ最適化チェックリスト**:
    - [ ] 必要最小限のサイズに縮小
    - [ ] 適切な圧縮形式を選択
    - [ ] Mip Maps生成を有効化
    - [ ] 不要なアルファチャンネル削除

## ⚙️ 物理シミュレーション最適化

### 軽量化優先の物理設定

!!! example "VRChat最適化物理設定テンプレート"

    **軽量化重視設定**:
    ```
    Particle Distance: 10-12
    Self Collision: 完全無効
    Collision Thickness: 最小値
    Simulation Quality: Low-Medium
    Iterations: 最小値
    ```

    **品質維持軽量化設定**:
    ```
    Particle Distance: 8-10
    Self Collision: 重要部分のみ有効
    Collision Thickness: 1-2mm
    Simulation Quality: Medium
    Bend/Stretch: 標準値維持
    ```

### 部分最適化テクニック

!!! example "パーツ別最適化戦略"

    **見えない・動かない部分の超軽量化**:
    ```
    靴の内側: Particle Distance 15+
    アクセサリー: Self Collision完全無効
    インナー（重ね着下）: 最小設定
    ```

    **重要部分の品質維持**:
    ```
    スカート裾: 標準設定維持
    袖口: 適度な品質設定
    胸部フィット: 必要な精度確保
    ```

## 🛠️ Unity統合段階での最適化

### Mesh最適化

!!! example "Unity でのMesh最適化"

    **Mesh結合**:
    1. **静的結合**: 動かないパーツの統合
       - `GameObject.CombineMeshes()` 使用
       - マテリアル統合と併用
    2. **動的結合**: ボーンウェイト保持統合
       - Skinned Mesh結合ツール使用

    **Mesh圧縮設定**:
    ```
    Mesh Compression: Medium (推奨)
    Optimize Mesh: 有効化
    Read/Write: 無効化（軽量化）
    ```

### LOD設定（上級テクニック）

!!! example "Level of Detail 設定"

    **LOD構成例**:
    ```
    LOD 0 (近距離): フル品質
    LOD 1 (中距離): 50%ポリゴン削減
    LOD 2 (遠距離): 75%ポリゴン削減
    LOD 3 (最遠距離): 最簡略化
    ```

    **実装手順**:
    1. Unity で **LOD Group** コンポーネント追加
    2. 距離別メッシュを準備
    3. 切り替え距離を設定
    4. VRChatでのテスト・調整

## 📊 パフォーマンス測定・分析

### 測定ツールと方法

!!! example "パフォーマンス測定の実践"

    **Unity内での測定**:
    1. **Profiler Window**: CPU/GPU/Memory使用量
    2. **Frame Debugger**: 描画処理の詳細分析
    3. **Statistics**: リアルタイム描画統計

    **VRChat SDK測定**:
    1. **Performance Rating**: 基本的な評価
    2. **Build & Test**: 実環境での動作確認
    3. **VRChat Analytics**: 実使用データ

### 最適化効果の確認

!!! example "最適化前後の比較方法"

    **測定項目**:
    ```
    Triangle Count: 変更前後の数値記録
    Material Slots: マテリアル数の変化
    Texture Memory: テクスチャ使用量
    Performance Rating: 評価ランクの変化
    FPS Impact: Unity Scene View でのFPS変化
    ```

    **記録テンプレート**:
    ```
    最適化対象: [衣装名]
    実施日: 2025-08-08

    【変更前】
    Triangle Count: 25,000
    Materials: 6個
    Performance: Medium

    【変更後】
    Triangle Count: 12,000 (-52%)
    Materials: 3個 (-50%)
    Performance: Good

    【実施内容】
    - Particle Distance: 6 → 8
    - マテリアル統合: 6 → 3
    - テクスチャ圧縮: 2048 → 1024
    ```

## 🎯 実践的最適化ワークフロー

### 段階的最適化手順

!!! example "効率的な最適化プロセス"

    **ステップ1: 現状分析** (15分)
    1. VRChat SDK Performance Rating確認
    2. 主な問題項目の特定
    3. 最適化目標の設定

    **ステップ2: 優先度付け** (10分)
    ```
    高優先度: Triangle Count, Material Slots
    中優先度: Texture Memory, Shader Quality
    低優先度: 細かな調整項目
    ```

    **ステップ3: 実施・検証** (60分)
    1. 高優先度項目から順次最適化
    2. 各変更後にBuild & Testで確認
    3. 問題があれば前段階に戻る

    **ステップ4: 最終調整** (15分)
    1. 全体的なバランス確認
    2. VRChat内での実際の動作テスト
    3. 設定内容の記録・保存

### 品質と軽量化のバランス調整

!!! example "バランス調整の判断基準"

    **妥協可能な品質項目**:
    - 見えない部分の詳細度
    - 極小装飾パーツの存在
    - 過度に高精細なテクスチャ
    - 使用頻度の低い特殊効果

    **維持すべき品質項目**:
    - 主要部分のシルエット
    - 顔に近い部分の品質
    - アニメーション時の自然さ
    - 基本的な物理挙動

## 🔧 トラブルシューティング

### 最適化関連の問題解決

??? question "「最適化したら見た目が悪くなった」"
    **対処法**:

    1. **段階的戻し**: 一つずつ設定を戻して原因特定
    2. **部分最適化**: 全体ではなく問題ない部分のみ最適化
    3. **代替手法**: 異なる最適化アプローチを試行
    4. **品質基準再検討**: 必要品質レベルの見直し

??? question "「Performance Rating が改善しない」"
    **対処法**:

    1. **項目別確認**: どの項目が基準を超えているか詳細確認
    2. **隠れた問題**: テクスチャメモリ、Shader複雑さなど
    3. **他の要因**: アバター本体、他のコンポーネントの影響
    4. **段階的アプローチ**: より大胆な最適化の実施

??? question "「軽量化しすぎて物理挙動がおかしい」"
    **対処法**:

    1. **Particle Distance調整**: 軽量化設定から少し品質寄りに
    2. **部分的品質向上**: 重要部分のみ設定を戻す
    3. **物理パラメータ再調整**: Bend/Stretchの微調整
    4. **Simulation Quality見直し**: 必要に応じてMediumに変更

### パフォーマンス問題の根本対策

!!! example "根本的な問題解決アプローチ"

    **設計段階からの最適化**:
    - 最初からVRChat基準を意識した設計
    - 過度に複雑な構造を避ける
    - 必要最小限の詳細レベルでの制作

    **ツール・ワークフローの改善**:
    - 自動最適化スクリプトの活用
    - プリセット設定の体系的管理
    - チェックリストによる確認作業

## ✅ 最適化完了チェックリスト

!!! note "VRChatパフォーマンス最適化完了確認"

    **Performance Rating**:
    - [ ] PC版「Good」以上を達成
    - [ ] Quest対応が必要な場合は対応基準クリア
    - [ ] 主要問題項目が全て解決済み

    **実測パフォーマンス**:
    - [ ] Unity Scene ViewでFPS影響が最小限
    - [ ] VRChat Build & Testで安定動作
    - [ ] 複数人環境でのテスト完了
    - [ ] ネットワーク負荷が適切範囲

    **品質確認**:
    - [ ] 見た目の品質が許容範囲
    - [ ] 物理挙動が自然
    - [ ] アニメーション時に問題なし
    - [ ] 他のアバターとの干渉最小限

    **記録・管理**:
    - [ ] 最適化内容を詳細記録
    - [ ] 設定ファイルのバックアップ作成
    - [ ] バージョン管理システムに保存
    - [ ] チーム内での情報共有完了

## 🌟 次のステップ

VRChat最適化をマスターしました！

これで、どんな環境でも快適に動作する高品質な衣装を制作できます。

**さらなるスキルアップ**:

[高度な衣装制作に挑戦 →](../garments/dress.md){ .md-button .md-button--primary }

[コミュニティでの作品共有 →](../resources/community.md){ .md-button }

**技術を深める**:

[Unity高度テクニック →](../unity/vrchat-sdk3.md){ .md-button }

## 📚 継続学習・コミュニティ参加

### 最適化技術の継続学習

**新技術・ツールの追跡**:
- VRChat SDK更新での新機能
- Unity新バージョンでの最適化機能
- コミュニティ開発の最適化ツール

**実践的スキル向上**:
- 異なる衣装タイプでの最適化経験積み重ね
- 他のクリエイターとの技術交流
- パフォーマンス競技会・イベント参加

### コミュニティへの貢献

**知識の共有**:
- 最適化テクニックのブログ・動画公開
- コミュニティフォーラムでの質問回答
- 勉強会・ワークショップの開催

**ツール・リソースの開発**:
- 最適化自動化スクリプト開発
- テンプレート・プリセット公開
- 教育コンテンツの制作

!!! success "最適化マスター達成！"
    おめでとうございます！VRChatで快適に動作する高品質衣装を制作する技術を完全にマスターしました。

    この知識は、あなたの作品をより多くの人に愛される、技術的に優れた衣装にするための重要な基盤です。ぜひ、実際の制作で活用し、素晴らしい作品を世界に発信してください！

## 💡 最適化の哲学

**「Perfect is the enemy of good」** - 完璧を求めすぎず、実用的な品質を重視する

VRChatの世界では、技術的完璧性よりも、多くの人が快適に体験できることが重要です。あなたの最適化技術は、VRChatコミュニティ全体の体験向上に貢献する価値ある技術です。
